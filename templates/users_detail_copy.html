{% extends 'new_index/base1.html' %}
{% load widget_tweaks %}
{% load static %}
{% load mfa %}

{% block extrahead %}
<style>

    .aktif{
        color: #33cc33;
    }
    .aktif-striped{
        color: #33cc33;
    } */
    .gridStyle {
        border: 1px solid rgb(212,212,212);
        width: 100%; 
        height: 200px;
    }
    .card-footer{
        display: none;
    }


.table-striped > tbody > tr:nth-child(2n+1) > td, .table-striped > tbody > tr:nth-child(2n+1) > th {
    background-color: red;
 }
 table {
    width: 100%;
    border-collapse: collapse;
}

table, th, td {
    border: 1px solid #ccc;
}

th, td {
    padding: 8px;
    text-align: left;
}

th {
    background-color: #007bff;
    color: white;
}
.orderable a {
    color: white;
}
</style>
{% endblock %} 
    {% block navbar %}
    {% include 'new_index/parts/navbar_kosong.html' %}
    {% endblock %}
    {% block konten_isi %}
    {% comment %} <div class="container-fluid"> {% endcomment %}
     <div class="card">
        <div class="card-header">
            <div class="" >
                {% comment %} <div class="card-header" style="background-color: #6C757D;">
                    <h1 style="color: white;font-size: 14px;font-weight: bold;">Persiapan &gt; Dokumen Seleksi</h1>
                </div> {% endcomment %}
                
                    <div class="card-body" id="profile" style="/*border-radius: 10px;*/box-shadow: 1px 1px 15px #b0b0b0;border-radius: 20px;margin-top: 13px; margin-bottom: 13px;margin-left:13px; margin-right: 13px;">
                        <form>
                            <div class="row profile-row">
                                <div class="col-md-4 relative">
                                    <div class="avatar">
                                        <div class="avatar-bg center"><img src="https://static.vecteezy.com/system/resources/previews/005/005/788/original/user-icon-in-trendy-flat-style-isolated-on-grey-background-user-symbol-for-your-web-site-design-logo-app-ui-illustration-eps10-free-vector.jpg" style="background: url(https://static.vecteezy.com/system/resources/previews/005/005/788/original/user-icon-in-trendy-flat-style-isolated-on-grey-background-user-symbol-for-your-web-site-design-logo-app-ui-illustration-eps10-free-vector.jpg);
                                            background-position: 50% 50%;
                                            height: 200px;
                                            width: 200px;
                                            background-size: cover;
                                            border-radius: 50%;
                                            margin-left: calc(50% - 100px); box-shadow: 1px 1px 15px #cacaca;" alt="Gambar" class="rounded-circle dropdown-toggle"></div>
                                    </div>
                                    <div class="avatar d-flex justify-content-center">
                                        {{ url|qrcode }}
                                    </div>
                                </div>
                                <div class="col-md-8">
                                    <h2 style="color: #007bff;">Profil Saya</h2>
                                    <hr>
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Nama Lengkap</label><input class="form-control" type="text"  disabled="" value="{{user.nama_lengkap}}"></div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Username</label><input class="form-control" type="text"  disabled="" value="{{user.username}}"></div>
                                        </div>
                                    </div>
                                    <div class="form-group mb-3"><label class="nama_label">Email </label><input class="form-control" type="email"  disabled="" value="{{user.email}}"></div>
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Nomor Handphone</label><input class="form-control" required="" disabled="" value="{{user.mobile_number}}"></div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Tipe Akun</label><input class="form-control" disabled="" value="{{user.get_user_type_display}}"></div>
                                        </div>
                                    </div>
                                    {% if user.user_type == 'A' %}
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">NIP </label><input class="form-control" type="text" id="nip" disabled="" value="{{admin.nip}}"></div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Jabatan</label><input class="form-control" type="text" id="jabatan"  disabled="" value="{{admin.nip}}"></div>
                                        </div>
                                        
                                    </div>
                                   
                                    {% elif user.user_type == 'C' %}
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">NIP </label><input class="form-control" type="text" id="nipc" disabled="" value="{{tim_lelang.nip}}"></div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Jabatan</label><input class="form-control" type="text" id="jabatanc"  disabled="" value="{{tim_lelang.jabatan}}"></div>
                                        </div>
                                        
                                    </div>
                                   
                                    {% elif user.user_type == 'V' %}
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">NIP </label><input class="form-control" type="text" id="nipd" disabled="" value="{{viewer.nip}}"></div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Jabatan</label><input class="form-control" type="text" id="jabatand"  disabled="" value="{{viewer.nip}}"></div>
                                        </div>
                                        
                                    </div>
                                   
                                    {% elif user.user_type == 'B' %}
                                    <h2 style="color: #007bff;">Profil Perusahaan</h2>                                 
                                    <div class="form-group mb-3"><label class="nama_label">Nama Perusahaan</label><input class="form-control" type="text" id="perusahaanb"  disabled="" value="{{perusahaan.nama_perusahaan}}"></div>
                                    <div class="form-group mb-3"><label class="nama_label">Alamat Perusahaan</label><input class="form-control" type="text" id="perusahaanb"  disabled="" value="{{perusahaan.alamat_perusahaan}}"></div>
                                        <div class="form-group mb-3" >
                                        <h2 style="color: #007bff;">Perwakilan</h2>
                                        <div id="perwakilan" style="overflow: auto;">
                                        </div>
                                   
                                            
                                    {% endif %}
                                   
                                    <div class="row">
                                          
                                       
                                            <div class="col-sm-12 col-md-6">
                                                <div class="form-group mb-3"><label class="nama_label">Status</label>{% if user.is_active %}<a class="btn btn-success" style="
                                                    display: flex;
                                                    flex-direction: row;
                                                    flex-wrap: nowrap;
                                                    align-content: flex-start;
                                                    justify-content: space-evenly;
                                                    align-items: center;
                                                ">Aktif</a>{% else %}<a class="btn btn-danger" style="
                                                display: flex;
                                                flex-direction: row;
                                                flex-wrap: nowrap;
                                                align-content: flex-start;
                                                justify-content: space-evenly;
                                                align-items: center;
                                            ">Tidak Aktif</a>{% endif %}</div>
                                            </div>
                                        
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Waktu Dibuat</label><input class="form-control" required="" disabled="" value="{{user.date_joined|date:"d F Y, H:i:s"}}"></div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group mb-3"><label class="nama_label">Terakhir Login</label><input class="form-control" disabled=""  value="{{user.last_login|date:"d F Y, H:i:s"}}"></div>
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="row">
                                        <div class="col-md-12 text-right"><a class="btn btn-primary form-btn" href="/accounts/ganti_password/">Ubah Kata Sandi</a></div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                
              </div>
        </div>
        
        
    </div> 
    <div class="modal fade" tabindex="-1" role="dialog" id="modal">
        <div class="modal-dialog" role="document">
          <div class="modal-content"></div>
        </div>
    </div>   
   
{% endblock %}

{% block footer %}
{% include 'new_index/parts/footer_dashboard.html' %}
{% endblock %}
{% block script %}
{% include 'js_tambahan/js_tambahan.html' %}
<script>
    var appendLog = function (s) {
        console.log(s);
    };
    var uri = '/events/';
    var es = new ReconnectingEventSource(uri);

    var firstConnect = true;

    es.onopen = function () {
      //if(!firstConnect) {
        appendLog('*** connected');
      //}
      firstConnect = false;
    };

    es.onerror = function () {
      appendLog('*** connection lost, reconnecting...');
    };

    es.addEventListener('stream-reset', function () {
      appendLog('*** client too far behind, please refresh');
    }, false);

    es.addEventListener('stream-error', function (e) {
      // hard stop
      es.close();
      e = JSON.parse(e.data);
      appendLog('*** stream error: ' + e.condition + ': ' + e.text);
    }, false);

    es.addEventListener('message', function (e) {
      console.log('event: ' + e.data);
      msg = JSON.parse(e.data);

      // if an event arrives that was already in the initial pageload,
      //   ignore it
      if($.inArray(msg.id, msg_ids) != -1) {
        return;
      }

      appendLog('<b>' + escapeHtml(msg.from) + '</b>: ' + escapeHtml(msg.text));
    }, false);

    {% if user.user_type == 'B' %}

        loadData({URL: '/userman/list_bidder_perwakilan2/69/', element_id: $("#perwakilan")})
        $("#perwakilan").on("click",".update",function() {
            showModal2({                     
                csrf: '{{csrf_token}}',
                formURL: "/userman/modal_bidder_perwakilan2/"+this.id+"/",
                drfURL: "/userman/api/v1/bidder_perwakilan/"+this.id+"/",
                method: "PUT",
                onSuccess: function(response) {
                    $("#modal").modal('hide');
                    loadData({URL: '/userman/list_bidder_perwakilan2/69/', element_id: $("#perwakilan")})
                }
            })
        });

        $("#perwakilan").on("click",".send",function() {
            id = this.id
            Swal.fire({
                title: 'Yakin akan mengirim speciment ttd?',
                text: "Ini tidak dapat diulang!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes!'
            }).then((result) => {
            if (result.isConfirmed) {
                $.ajax('/userman/api/v1/bidder_perwakilan/'+id+'/send_speciment/',   
                {
                success: function (data, status, xhr) {// success callback function
                    Swal.fire(data.status.message)
                }
                });
            }
            })     
        });

    {% endif %}
</script>
{% endblock %}